---
import { Card } from '@/components/Card'
import Layout from '@/layouts/Simple.astro'
import { formatDate } from '@/lib/formatDate'
import { relativeDate } from '@/lib/relativeDate'
import { getCollection } from 'astro:content'

const posts = (await getCollection('blog')).sort(
  (a, z) => z.data.date.getTime() - a.data.date.getTime()
)
---

<Layout>
  <Fragment slot="title">
    Writing on software design, company building, and the aerospace industry.
  </Fragment>

  <Fragment slot="intro">
    All of my long-form thoughts on programming, leadership, product design, and
    more, collected in chronological order.
  </Fragment>

  <div
    class="md:border-l md:border-zinc-100 md:pl-6 md:dark:border-zinc-700/40"
  >
    <div class="flex max-w-3xl flex-col space-y-16">
      {
        posts.map((post) => (
          <article class="md:grid md:grid-cols-4 md:items-baseline">
            <Card className="md:col-span-3">
              <Card.Title href={`/blog/${post.slug}`}>
                {post.data.title}
              </Card.Title>
              <Card.Eyebrow
                as="time"
                className="md:hidden"
                datetime={formatDate(post.data.date)}
                decorate
                title={formatDate(post.data.date)}
              >
                {relativeDate(post.data.date)}
              </Card.Eyebrow>
              <Card.Description>{post.data.summary}</Card.Description>
              <Card.Cta>Read article</Card.Cta>
            </Card>
            <Card.Eyebrow
              as="time"
              className="mt-1 hidden md:block"
              datetime={formatDate(post.data.date)}
              title={formatDate(post.data.date)}
            >
              {relativeDate(post.data.date)}
            </Card.Eyebrow>
          </article>
        ))
      }
    </div>
  </div>
</Layout>
